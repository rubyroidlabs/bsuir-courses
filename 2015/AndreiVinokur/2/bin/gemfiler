#!/usr/bin/env ruby

Dir['./../lib/*.rb'].each{ |f| require(f) }

name, interval = ARGV

if ARGV.size < 2 || ARGV.size > 3
  puts 'Incorrect number of arguments'
  puts 'Template: ruby gemfiler <gem_name> [\'version conditions\']'
  exit
end

unless name =~ /\w+/
  puts 'Incorrect name of gem'
  puts 'Template: ruby gemfiler <gem_name> [\'version conditions\']'
  exit
end

unless interval =~ /[~><][=>]\s*(\d+\.)*\d+/
  puts 'Incorrect interval of versions of gem'
  puts 'Template: ruby gemfiler <gem_name> [\'version conditions\']'
  exit
end

begin
versions = AddingVersions.new(name).add
  rescue StandardError
  puts 'Check you internet connection'
  exit
end

filtered_versions = VersionFilter.new(versions).filter(interval)

Visualiser.new(versions).visualise(filtered_versions)

